Search.setIndex({"docnames": ["analyze_prob_escape", "analyze_variant_counts", "avg_antibody_escape", "avg_antibody_escape_2130-1-0114-112", "avg_antibody_escape_COV2-2130", "compare_IC50s", "fit_polyclonal", "fit_polyclonal_Lib-2_2022-03-14_thaw-3_2130-1-0114-112_1", "fit_polyclonal_Lib-2_2022-03-14_thaw-3_COV2-2130_1", "fit_polyclonal_Lib-3_2022-03-14_thaw-3_2130-1-0114-112_1", "fit_polyclonal_Lib-3_2022-03-14_thaw-3_COV2-2130_1", "index"], "filenames": ["analyze_prob_escape.nblink", "analyze_variant_counts.nblink", "avg_antibody_escape.rst", "avg_antibody_escape_2130-1-0114-112.nblink", "avg_antibody_escape_COV2-2130.nblink", "compare_IC50s.nblink", "fit_polyclonal.rst", "fit_polyclonal_Lib-2_2022-03-14_thaw-3_2130-1-0114-112_1.nblink", "fit_polyclonal_Lib-2_2022-03-14_thaw-3_COV2-2130_1.nblink", "fit_polyclonal_Lib-3_2022-03-14_thaw-3_2130-1-0114-112_1.nblink", "fit_polyclonal_Lib-3_2022-03-14_thaw-3_COV2-2130_1.nblink", "index.rst"], "titles": ["Probabilities of escape and neutralization in antibody selections", "Counts of variants", "Antibody-escape averaged across replicates", "Average antibody escape across <code class=\"docutils literal notranslate\"><span class=\"pre\">polyclonal</span></code> models", "Average antibody escape across <code class=\"docutils literal notranslate\"><span class=\"pre\">polyclonal</span></code> models", "Compare antibody neutralization values", "Fit <code class=\"docutils literal notranslate\"><span class=\"pre\">polyclonal</span></code> models", "Fit polyclonal model", "Fit polyclonal model", "Fit polyclonal model", "Fit polyclonal model", "Deep mutational scanning of SARS-CoV-2 Omicron BA.1 spike and mapping of escape mutations for COV2-2130 and its derivative antibody"], "terms": {"thi": [0, 1, 3, 4, 5, 7, 8, 9, 10, 11], "notebook": [0, 1, 3, 4], "analyz": [0, 1], "import": [0, 1, 3, 4, 5, 7, 8, 9, 10], "python": [0, 1, 3, 4, 5, 7, 8, 9, 10], "modul": [0, 1, 3, 4, 5, 7, 8, 9, 10], "1": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "o": [0, 1, 3, 4, 5], "altair": [0, 1, 5, 7, 8, 9, 10], "alt": [0, 1, 5, 7, 8, 9, 10], "dms_variant": [0, 1], "codonvariantt": 0, "panda": [0, 1, 3, 4, 5, 7, 8, 9, 10], "pd": [0, 1, 3, 4, 5, 7, 8, 9, 10], "yaml": [0, 1, 3, 4, 5, 7, 8, 9, 10], "2": [0, 1, 3, 4, 5, 7, 8, 9, 10], "allow": [0, 1, 7, 8, 9, 10], "more": [0, 1, 7, 8, 9, 10, 11], "row": [0, 1, 7, 8, 9, 10], "_": [0, 1, 7, 8, 9, 10], "data_transform": [0, 1, 7, 8, 9, 10], "disable_max_row": [0, 1, 7, 8, 9, 10], "get": [0, 3, 4, 5, 7, 8, 9, 10], "configur": [0, 1, 5, 7, 8, 9, 10], "3": [0, 1, 3, 4, 5, 7, 8, 9, 10], "If": [0, 1], "you": [0, 1, 5], "ar": [0, 7, 8, 9, 10, 11], "run": [0, 1, 11], "interact": [0, 1, 5], "rather": [0, 1], "than": [0, 1], "pipelin": [0, 1, 7, 8, 9, 10], "handl": [0, 1], "work": [0, 1], "directori": [0, 1], "mai": [0, 1], "have": [0, 1], "first": [0, 1, 3, 4, 7, 8, 9, 10], "chdir": [0, 1], "appropri": [0, 1], "open": [0, 1, 3, 4, 5, 7, 8, 9, 10], "config": [0, 1, 5, 7, 8, 9, 10], "f": [0, 1, 3, 4, 5, 7, 8, 9, 10], "safe_load": [0, 1, 3, 4, 5, 7, 8, 9, 10], "data": [0, 1, 3, 4], "frame": [0, 1, 3, 4], "4": [0, 1, 3, 4, 5, 7, 8, 9, 10], "antibody_select": 0, "read_csv": [0, 1, 3, 4, 5, 7, 8, 9, 10], "dtype": [0, 5, 7, 8, 9, 10], "str": [0, 1, 3, 4, 7, 8, 9, 10], "5": [0, 1, 3, 4, 5, 7, 8, 9, 10], "selection_group": [0, 3, 4], "uniqu": [0, 3, 4, 7, 8, 9, 10], "prob_escap": [0, 7, 8, 9, 10], "concat": [0, 1], "path": [0, 1, 3, 4, 5], "join": [0, 1, 5], "prob_escape_dir": 0, "_prob_escap": 0, "csv": [0, 1, 3, 4, 5, 7, 8, 9, 10], "keep_default_na": [0, 7, 8, 9, 10], "fals": [0, 1, 3, 4, 5, 7, 8, 9, 10], "na_valu": [0, 7, 8, 9, 10], "nan": [0, 7, 8, 9, 10], "ignore_index": 0, "true": [0, 1, 5, 7, 8, 9, 10], "neut_standard_frac": 0, "_neut_standard_frac": 0, "na_filt": [0, 1], "none": [0, 1, 3, 4, 7, 8, 9, 10], "merg": [0, 1, 5], "drop": [0, 1, 3, 4], "column": [0, 1, 3, 4, 5, 7, 8, 9, 10], "antibody_concentr": [0, 1, 7, 8, 9, 10], "can": [0, 1, 3, 4, 5], "round": [0, 3, 4, 7, 8, 9, 10], "how": [0, 7, 8, 9, 10], "left": [0, 1], "valid": 0, "one_to_on": [0, 1], "assert": [0, 1, 3, 4, 7, 8, 9, 10], "notnul": [0, 1, 7, 8, 9, 10], "all": [0, 1, 3, 4, 7, 8, 9, 10], "_neutral": 0, "sampl": [0, 1], "order": [0, 1, 7, 8, 9, 10], "plot": [0, 1, 3, 4, 5, 7, 8, 9, 10], "sample_ord": 0, "sort_valu": [0, 1, 3, 4, 7, 8, 9, 10], "librari": [0, 3, 4], "date": [0, 1, 3, 4], "virus_batch": [0, 1, 3, 4], "replic": [0, 1, 3, 4, 5, 11], "antibody_library_sampl": 0, "tolist": [0, 1, 5, 7, 8, 9, 10], "make": [0, 1], "an": [0, 1, 5], "show": [0, 1], "each": [0, 1, 3, 4, 5, 7, 8, 9, 10], "its": 0, "control": 0, "note": [0, 1, 7, 8, 9, 10], "symlog": [0, 1, 7, 8, 9, 10], "scale": [0, 1, 5, 7, 8, 9, 10], "6": [0, 1, 3, 4, 5, 7, 8, 9, 10], "tidi": 0, "version": [0, 1], "melt_col": 0, "antibody_frac": 0, "neut_standard_fracs_tidi": 0, "melt": [0, 7, 8, 9, 10], "id_var": [0, 7, 8, 9, 10], "c": [0, 1, 5, 7, 8, 9, 10], "value_var": 0, "value_nam": [0, 7, 8, 9, 10], "var_nam": [0, 7, 8, 9, 10], "sample_typ": [0, 1], "assign": [0, 1, 3, 4, 7, 8, 9, 10], "lambda": [0, 1, 3, 4, 5, 7, 8, 9, 10], "x": [0, 1, 3, 4, 5, 7, 8, 9, 10], "replac": 0, "_frac": 0, "library_sampl": [0, 1], "antibody_sampl": 0, "set": [0, 7, 8, 9, 10], "up": 0, "over": [0, 1, 5, 11], "other": 0, "interest": 0, "selection_nam": 0, "selection_point": [0, 1], "field": [0, 1], "col": [0, 1], "bind": [0, 1], "binding_select": [0, 1], "option": [0, 1], "label": [0, 1], "name": [0, 1, 7, 8, 9, 10], "neut_standard_fracs_chart": 0, "chart": [0, 1, 5, 7, 8, 9, 10], "encod": [0, 1, 5, 7, 8, 9, 10], "titl": [0, 1, 5, 7, 8, 9, 10], "type": [0, 1, 5, 7, 8, 9, 10], "constant": [0, 7, 8, 9, 10], "0": [0, 1, 5, 7, 8, 9, 10], "02": [0, 10], "domainmax": [0, 5], "y": [0, 1, 5, 7, 8, 9, 10], "sort": [0, 1], "color": [0, 1, 7, 8, 9, 10], "shape": [0, 1], "tooltip": [0, 1, 5, 7, 8, 9, 10], "format": [0, 1, 5, 7, 8, 9, 10], "2g": [0, 1], "els": [0, 1, 5, 7, 8, 9, 10], "mark_point": [0, 1], "properti": [0, 1, 5, 7, 8, 9, 10], "width": [0, 1, 5, 7, 8, 9, 10], "275": [0, 1], "height": [0, 1, 5, 7, 8, 9, 10], "step": [0, 1, 7, 8, 9, 10], "14": [0, 1, 3, 4, 7, 8, 9, 10], "add_param": [0, 1], "configure_axi": [0, 1, 5, 7, 8, 9, 10], "labellimit": [0, 1], "500": [0, 1], "transform_filt": [0, 1], "averag": [0, 5, 7, 8, 9, 10, 11], "given": 0, "just": 0, "primari": 0, "target": [0, 1], "readi": 0, "do": 0, "few": 0, "transform": [0, 1], "7": [0, 1, 3, 4, 7, 8, 9, 10], "cols_to_melt": 0, "prob_escape_uncensor": [0, 7, 8, 9, 10], "onli": [0, 1, 7, 8, 9, 10], "implement": 0, "neut_to_plot": 0, "censor": [0, 7, 8, 9, 10], "map": [0, 1, 3, 4, 7, 8, 9, 10], "ye": [0, 1], "n_aa_substitut": 0, "n": [0, 1, 3, 4, 7, 8, 9, 10], "max": [0, 1, 3, 4, 7, 8, 9, 10], "renam": [0, 1, 3, 4, 7, 8, 9, 10], "endswith": 0, "many_to_on": [0, 1], "now": [0, 1, 3, 4, 5], "mouseov": [0, 1, 7, 8, 9, 10], "point": [0, 1, 7, 8, 9, 10, 11], "detail": [0, 1, 5, 11], "us": [0, 1, 7, 8, 9, 10, 11], "dropdown": [0, 11], "subset": [0, 1], "click": [0, 1, 11], "legend": [0, 1], "specif": [0, 1], "amino": 0, "acid": 0, "substitut": [0, 7, 8, 9, 10], "valu": [0, 1, 3, 4, 7, 8, 9, 10, 11], "raw": 0, "should": [0, 1], "worri": 0, "uncensor": [0, 7, 8, 9, 10], "look": [0, 1, 3, 4], "dramat": 0, "differ": [0, 1, 3, 4], "8": [0, 1, 3, 4, 7, 8, 9, 10], "censored_select": 0, "n_aa_substitutions_select": 0, "neutralization_chart": 0, "domain": [0, 1], "between": [0, 1, 7, 8, 9, 10], "rang": [0, 7, 8, 9, 10], "triangl": 0, "down": [0, 1], "3g": [0, 1, 5, 7, 8, 9, 10], "_count": 0, "startswith": [0, 1], "fill": [0, 1, 5], "size": [0, 1, 5, 7, 8, 9, 10], "50": [0, 1, 8, 10], "opac": [0, 1, 5], "300": [0, 1, 5], "we": [0, 1, 3, 4, 5, 7, 8, 9, 10], "calcul": [0, 1], "some": [0, 1], "minimum": 0, "threshold": [0, 7, 8, 9, 10], "draw": 0, "boxplot": 0, "black": [0, 1], "line": [0, 1], "median": [0, 3, 4, 5], "box": 0, "span": [0, 1], "25th": 0, "75th": 0, "percentil": [0, 1], "maximum": [0, 7, 8, 9, 10], "red": 0, "indciat": 0, "bar": [0, 1], "certain": 0, "axi": [0, 1, 5, 7, 8, 9, 10], "9": [0, 1, 3, 4, 7, 8, 9, 10], "no_antibody_count_boxplot_df": 0, "antibody_count": [0, 7, 8, 9, 10], "no_antibody_count_threshold": [0, 7, 8, 9, 10], "drop_dupl": [0, 1], "variant_above_threshold": 0, "astyp": [0, 1], "int": [0, 1], "count_above_threshold": 0, "groupbi": [0, 1, 7, 8, 9, 10], "as_index": [0, 1, 7, 8, 9, 10], "aggreg": [0, 1, 3, 4, 7, 8, 9, 10], "namedagg": [0, 1, 7, 8, 9, 10], "percentile_25": 0, "": [0, 1, 7, 8, 9, 10], "quantil": [0, 1], "25": [0, 1, 7, 8, 9, 10], "percentile_75": 0, "75": 0, "min": [0, 1, 3, 4, 7, 8, 9, 10], "nvariant": 0, "total_count": 0, "sum": [0, 1], "variants_above_threshold": 0, "counts_above_threshold": 0, "frac_counts_above_threshold": 0, "frac_variants_above_threshold": 0, "len": [0, 1, 3, 4, 7, 8, 9, 10], "nuniqu": [0, 1, 7, 8, 9, 10], "no_antibody_count_bas": 0, "float": [0, 1, 5, 7, 8, 9, 10], "no_antibody_count_quartile_bar": 0, "20": [0, 1], "x2": [0, 1], "mark_bar": [0, 1], "blue": 0, "no_antibody_count_range_lin": 0, "mark_rul": [0, 1], "no_antibody_count_median_lin": 0, "xoffset": 0, "x2offset": 0, "no_antibody_count_chart": 0, "350": 0, "zip": [0, 1], "abov": [0, 1], "condit": [0, 1], "10": [0, 1, 3, 4, 7, 8, 9, 10], "frac_counts_df": 0, "fraction_type_select": 0, "fraction_typ": 0, "frac_counts_chart": 0, "transform_fold": [0, 1], "fold": 0, "as_": 0, "q": [0, 1], "200": [0, 1, 7, 8, 9, 10], "measur": 0, "exce": 0, "11": [0, 1, 7, 8, 9, 10], "prob_escape_filt": 0, "queri": [0, 1, 3, 4, 7, 8, 9, 10], "prob": 0, "non": 0, "filter": [0, 5, 7, 8, 9, 10], "The": [0, 1, 7, 8, 9, 10], "vertic": 0, "i": [0, 1, 5, 7, 8, 9, 10, 11], "thin": 0, "extend": 0, "from": [0, 1, 3, 4, 5, 7, 8, 9, 10], "either": [0, 7, 8, 9, 10], "12": [0, 1, 7, 8, 9, 10], "prob_escape_boxplot_df": 0, "prob_escape_bas": 0, "prob_escape_quartile_bar": 0, "prob_escape_range_lin": 0, "prob_escape_median_lin": 0, "prob_escape_chart": 0, "censored_dropdown_select": 0, "list": [0, 1], "same": [0, 1, 7, 8, 9, 10], "13": [0, 1, 7, 8, 9, 10], "prob_escape_tidi": 0, "corr": 0, "util": [0, 1], "tidy_to_corr": 0, "df": [0, 1], "sample_col": 0, "label_col": 0, "value_col": 0, "group_col": 0, "r2": 0, "add": 0, "suffix": 0, "_1": 0, "_2": 0, "left_on": 0, "right_on": 0, "ident": 0, "both": [0, 1, 7, 8, 9, 10], "equal": 0, "where": [0, 1], "na": 0, "fh": [0, 1], "fast": [0, 1], "bloom_j": [0, 1], "computational_notebook": [0, 1], "bdadonai": [0, 1], "2023": [0, 1, 7, 8, 9, 10], "sar": [0, 1], "cov": [0, 1], "2_omicron_ba": [0, 1, 11], "1_spike_dms_cov2": [0, 1, 11], "2130": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10], "snakemak": [0, 1, 7, 8, 9, 10, 11], "conda": [0, 1], "0773f21e8ca7fd0085a59061dd1b6349_": [0, 1], "lib": [0, 1, 3, 4, 6, 7, 8, 9, 10], "python3": [0, 1], "site": [0, 1, 3, 4, 7, 8, 9, 10, 11], "packag": [0, 1], "py": [0, 1], "360": 0, "futurewarn": 0, "default": 0, "numeric_onli": 0, "dataframegroupbi": 0, "deprec": [0, 1], "In": 0, "futur": 0, "specifi": [0, 1, 7, 8, 9, 10], "which": [0, 1], "function": [0, 3, 4, 7, 8, 9, 10], "library_corr": 0, "corr_chart": [0, 5], "antibody_sample_1": 0, "antibody_sample_2": 0, "zero": [0, 1], "mark_rect": [0, 1], "stroke": [0, 1], "15": [0, 1, 7, 9, 10], "displai": [0, 1, 3, 4, 7, 8, 9, 10], "bio": 1, "seqio": 1, "inform": [1, 7, 8, 9, 10], "read": [1, 5], "barcode_run": 1, "processed_barcode_run": 1, "fate": 1, "e": 1, "g": 1, "did": 1, "thei": 1, "barcode_fates_dir": 1, "fastq_r1": 1, "not_valid": 1, "selection_col": 1, "exclude_after_count": 1, "antibodi": [1, 7, 8, 9, 10], "select": [1, 7, 8, 9, 10, 11], "dropna": 1, "fate_chart": 1, "nice": 1, "revers": 1, "subdir": 1, "barcode_counts_dir": 1, "barcode_counts_invalid_dir": 1, "number": [1, 3, 4, 7, 8, 9, 10, 11], "separ": 1, "ones": 1, "avg_count": 1, "mean_count": 1, "mean": [1, 7, 8, 9, 10], "n_barcod": 1, "below": [1, 7, 8, 9, 10, 11], "bottom": 1, "valid_select": 1, "selection_multi": 1, "avg_counts_chart": 1, "65": [1, 7], "altairdeprecationwarn": 1, "39": [1, 3, 4, 7, 8, 9, 10], "invers": 1, "simpson": 1, "index": [1, 3, 4], "well": 1, "total": 1, "def": 1, "inverse_simpson_index": 1, "arr": 1, "isi": 1, "d": 1, "ni": 1, "return": 1, "unique_bcs_and_isi": 1, "inv_simpson_index": 1, "n_unique_barcod": 1, "metric": 1, "shown": [1, 7, 8, 9, 10], "when": 1, "mous": [1, 5, 11], "unique_barcodes_chart": 1, "top": 1, "along": 1, "rank": 1, "among": 1, "ranked_invalid": 1, "overall_rank": 1, "ascend": [1, 3, 4], "method": 1, "mani": [1, 7, 8, 9, 10, 11], "most": 1, "abund": 1, "ani": [1, 3, 4, 7, 8, 9, 10], "invalid_topn": 1, "invalid_barcodes_in_top_10": 1, "top_invalid_rank": 1, "top_invalid_barcod": 1, "reset_index": 1, "topn_chart": 1, "print": [1, 3, 4, 7, 8, 9, 10], "ntop": 1, "2022": [1, 3, 4], "03": [1, 3, 4, 6, 7, 8, 9, 10], "14_thaw": [1, 3, 4, 6, 7, 8, 9, 10], "3_antibody_2130": 1, "0114": [1, 2, 3, 5, 6, 7, 9, 11], "112_0": 1, "atatagacacgtgaca": 1, "aaataagtcaacaaac": 1, "accccgtgctgagaaa": 1, "3_antibody_cov2": 1, "2130_200": 1, "0_1": 1, "gactttcgtacgatgt": 1, "2130_400": 1, "cagagataacaagcaa": 1, "2130_50": 1, "ccccatttcagccccc": 1, "barcodes_by_librari": 1, "codon_vari": 1, "libraries_w_barcod": 1, "n_libraries_w_barcod": 1, "88547": 1, "5786": 1, "134841": 1, "16": 1, "125097": 1, "neut_standard": 1, "overal": 1, "see": [1, 11], "expect": 1, "indic": [1, 7, 8, 9, 10], "unless": 1, "lot": 1, "overlap": 1, "two": 1, "would": 1, "tabl": [1, 11], "counts_by_librari": 1, "n_count": 1, "frac_count": 1, "categori": 1, "ordered_cat": 1, "category_select": 1, "counts_by_library_chart": 1, "250": [1, 10], "suffici": [1, 7, 8, 9, 10], "determin": 1, "without": 1, "don": 1, "t": [1, 3, 4], "havea": 1, "17": [1, 7, 8], "requir": 1, "min_avg_count": 1, "valid_count": 1, "adequate_count": 1, "adequate_counts_select": 1, "adequ": 1, "save": [1, 3, 4, 7, 8, 9, 10], "variant_avg_counts_plot": 1, "write": 1, "variant_avg_counts_csv": 1, "to_csv": [1, 3, 4], "float_format": 1, "1f": 1, "insufficient_count": 1, "insuffici": 1, "despit": 1, "result": [1, 3, 4, 5, 7, 8, 9, 10], "variant_count": 1, "avg_counts_per_vari": 1, "html": [1, 3, 4], "creat": [1, 7, 8, 9, 10], "exclus": 1, "18": [1, 10], "geneseq": 1, "gene_sequence_codon": 1, "fasta": 1, "seq": 1, "barcode_variant_fil": 1, "allowgap": 1, "substitutions_are_codon": 1, "primary_target": 1, "substitutions_col": 1, "codon_substitut": 1, "add_sample_counts_df": 1, "codon": [1, 11], "19": 1, "avg_mut": 1, "numcodonmutsbytyp": 1, "variant_typ": 1, "num_muts_count": 1, "remov": 1, "categor": 1, "enabl": 1, "mutation_typ": 1, "mut_types_sort": 1, "mut_type_select": 1, "ve": 1, "avg_muts_chart": 1, "m": [1, 3, 4], "grid": [1, 5, 7, 8, 9, 10], "descend": 1, "21": [1, 8, 10], "refer": [1, 7, 8, 9, 10, 11], "site_numbering_map": [1, 3, 4, 7, 8, 9, 10], "site_freq": 1, "mutcount": 1, "mut_typ": 1, "aa": 1, "sequential_sit": [1, 3, 4, 7, 8, 9, 10], "wildtyp": 1, "reference_sit": [1, 3, 4, 7, 8, 9, 10], "int64": 1, "observ": 1, "n_variants_df": 1, "primary_target_onli": 1, "n_variant": [1, 7, 8, 9, 10], "percent": 1, "100": 1, "smaller": 1, "pivot": 1, "wide": 1, "form": 1, "lookup": 1, "22": [1, 9], "integ": 1, "library_sample_cod": 1, "enumer": 1, "freq": 1, "site_freqs_wid": 1, "pivot_t": 1, "fill_valu": 1, "code": [1, 11], "library_sample_lookup": 1, "23": [1, 9], "zoom_brush": 1, "selection_interv": 1, "mark": 1, "brushconfig": 1, "strokewidth": 1, "zoom_bar": 1, "lightgrei": 1, "550": 1, "zoom": 1, "site_freqs_bas": 1, "orient": [1, 3, 4], "site_freqs_chart": 1, "layer": 1, "mark_lin": [1, 7, 8, 9, 10], "transform_lookup": 1, "from_": 1, "lookupdata": 1, "kei": 1, "facet": 1, "resolve_scal": 1, "independ": 1, "site_freqs_zoom_chart": 1, "24": 1, "variant_count_df": 1, "aa_substitut": [1, 5, 7, 8, 9, 10], "10th": 1, "90th": 1, "top_n": 1, "variant_counts_top_n": 1, "head": 1, "percentile_10": 1, "percentile_90": 1, "min_perc": 1, "max_perc": 1, "112_3": 1, "tacccatggatacgat": 1, "1974508": 1, "thaw": [1, 3, 4], "112": [1, 2, 3, 5, 7, 9, 11], "2_2022": [1, 3, 4, 6, 7, 8], "051008": 1, "882157": 1, "107804": 1, "722275": 1, "tacgtcgcaatggtcc": 1, "1808754": 1, "703574": 1, "gcgattcacgcgttgg": 1, "1794913": 1, "591059": 1, "ccatctagtggctagg": 1, "1563551": 1, "710290": 1, "gtgcagtagtaaagta": 1, "1435294": 1, "667674": 1, "full": 1, "fraction": 1, "also": [1, 7, 8, 9, 10], "26": 1, "variant_selector": 1, "empti": 1, "target_select": 1, "variant_counts_top_n_bas": 1, "variant_counts_top_n_point": 1, "40": 1, "variant_counts_top_n_bar": 1, "variant_counts_top_n_rul": 1, "variant_counts_top_n_chart": 1, "vegalit": 1, "v5": 1, "api": 1, "316": 1, "sure": 1, "here": [1, 7, 8, 9, 10, 11], "written": 1, "27": [1, 10], "variant_counts_dir": 1, "isfil": [1, 3, 4], "cannot": 1, "find": 1, "test": 1, "assert_frame_equ": 1, "variant_call_support": 1, "159896_1": 1, "79948_1": 1, "9974_1": 1, "3_no": 1, "antibody_control_1": 1, "3_2022": [1, 3, 4, 6, 9, 10], "cov2": [2, 4, 5, 8, 10], "comput": [3, 4], "multipl": [3, 4], "fit": [3, 4, 5, 11], "etc": [3, 4, 11], "pickl": [3, 4, 5, 7, 8, 9, 10], "polyclonalharmonizeerror": [3, 4], "parameter": [3, 4, 7, 8, 9, 10], "variabl": [3, 4, 7, 8, 9, 10], "papermil": [3, 4, 7, 8, 9, 10], "paramet": [3, 4, 7, 8, 9, 10], "cell": [3, 4, 7, 8, 9, 10], "tag": [3, 4, 7, 8, 9, 10], "escape_avg_method": [3, 4], "polyclonal_config": [3, 4, 7, 8, 9, 10], "muteffects_csv": [3, 4], "avg_pickl": [3, 4], "escape_plot": [3, 4], "avg_escap": [3, 4], "rep_escap": [3, 4], "selection_groups_dict": [3, 4], "3_2130": [3, 6, 7, 9], "112_1": [3, 6, 7, 9], "pickle_fil": [3, 4, 7, 8, 9, 10], "polyclonal_fit": [3, 4, 7, 8, 9, 10], "muteffects_funct": [3, 4], "muteffects_observ": [3, 4], "site_numb": [3, 4], "antibody_escap": [3, 4], "112_avg": 3, "112_rep": 3, "112_escape_plot_unformat": 3, "convert": [3, 4], "epitop": [3, 4, 7, 8, 9, 10], "models_df": [3, 4], "datafram": [3, 4], "from_dict": [3, 4], "follow": [3, 4], "file": [3, 4], "load": [3, 4, 5], "rb": [3, 4, 5], "explod": [3, 4], "n_epitop": [3, 4, 7, 8, 9, 10], "build": [3, 4], "start": [3, 4, 7, 8, 9, 10], "continu": [3, 4], "fewer": [3, 4], "harmon": [3, 4], "try": [3, 4, 11], "avg_model": [3, 4], "polyclonalaverag": [3, 4], "default_avg_to_plot": [3, 4], "successfulli": [3, 4, 7, 8, 9, 10], "except": [3, 4], "exc": [3, 4], "fail": [3, 4], "error": [3, 4], "correl": [3, 4], "mut_escape_corr_heatmap": [3, 4], "activ": [3, 4, 7, 8, 9, 10], "activity_wt_barplot": [3, 4, 7, 8, 9, 10], "site_map": [3, 4], "antibody_config": [3, 4, 7, 8, 9, 10], "plot_kwarg": [3, 4, 7, 8, 9, 10], "plot_titl": [3, 4, 7, 8, 9, 10], "region": [3, 4, 7, 8, 9, 10], "site_zoom_bar_color_col": [3, 4, 7, 8, 9, 10], "addtl_slider_stat": [3, 4, 7, 8, 9, 10], "times_seen": [3, 4, 5, 7, 8, 9, 10], "elif": [3, 4, 7, 8, 9, 10], "addtl_tooltip_stat": [3, 4, 7, 8, 9, 10], "append": [3, 4, 5, 7, 8, 9, 10], "df_to_merg": [3, 4, 7, 8, 9, 10], "muteffect": [3, 4], "effect": [3, 4, 7, 8, 9, 10], "mutant": [3, 4], "addtl_slider_stats_hide_not_filt": [3, 4], "del": [3, 4, 7, 8, 9, 10], "escape_chart": [3, 4], "mut_escape_plot": [3, 4, 7, 8, 9, 10], "wb": [3, 4, 7, 8, 9, 10], "dump": [3, 4, 7, 8, 9, 10], "mut_escape_df": [3, 4, 7, 8, 9, 10], "per": [3, 4, 7, 8, 9, 10], "mut_escape_df_repl": [3, 4], "3_cov2": [4, 6, 8, 10], "2130_1": [4, 6, 8, 10], "2130_avg": 4, "2130_rep": 4, "2130_escape_plot_unformat": 4, "functool": 5, "reduc": 5, "polyclon": [5, 11], "model": [5, 11], "escape_dir": 5, "_avg": 5, "h": 5, "variants_df": 5, "mutat": [5, 7, 8, 9, 10], "icxx": 5, "loc": 5, "n_models_x": 5, "n_models_i": 5, "times_seen_x": 5, "times_seen_i": 5, "ic50": 5, "across": [5, 7, 8, 9, 10, 11], "median_ic50_x": 5, "arbitrari": 5, "unit": 5, "log": 5, "20000": 5, "domainmin": 5, "0004": 5, "median_ic50_i": 5, "mark_circl": 5, "60": 5, "prob_escape_csv": [7, 8, 9, 10], "n_thread": [7, 8, 9, 10], "112_1_prob_escap": [7, 9], "probabl": [7, 8, 9, 10, 11], "escap": [7, 8, 9, 10], "those": [7, 8, 9, 10], "count": [7, 8, 9, 10, 11], "nread": [7, 8, 9, 10], "rest": [7, 8, 9, 10], "rais": [7, 8, 9, 10], "valueerror": [7, 8, 9, 10], "lack": [7, 8, 9, 10], "min_epitope_activity_to_includ": [7, 8, 9, 10], "38": [7, 8, 9, 10], "slider_binding_range_kwarg": [7, 8, 9, 10], "n_model": [7, 8, 9, 10], "heatmap_max_at_least": [7, 8, 9, 10], "heatmap_min_at_least": [7, 8, 9, 10], "max_epitop": [7, 8, 9, 10], "fit_kwarg": [7, 8, 9, 10], "reg_escape_weight": [7, 8, 9, 10], "reg_spread_weight": [7, 8, 9, 10], "reg_activity_weight": [7, 8, 9, 10], "spatial": [7, 8, 9, 10], "distanc": [7, 8, 9, 10], "relev": [7, 8, 9, 10], "spatial_dist": [7, 8, 9, 10], "residu": [7, 8, 9, 10], "pair": [7, 8, 9, 10], "No": [7, 8, 9, 10], "variant": [7, 8, 9, 10, 11], "pass": [7, 8, 9, 10], "upstream": [7, 8, 9, 10], "concentr": [7, 8, 9, 10], "barcod": [7, 8, 9, 10, 11], "1599": [7, 9], "90191": [7, 8], "7995": [7, 9], "9974": [7, 9], "weight": [7, 8, 9, 10], "regardless": [7, 8, 9, 10], "ha": [7, 8, 9, 10], "max_aa_sub": [7, 8, 9, 10], "group": [7, 8, 9, 10], "mean_prob_escap": [7, 8, 9, 10], "n_sub": [7, 8, 9, 10], "aa_substitutions_refer": [7, 8, 9, 10], "split": [7, 8, 9, 10], "clip": [7, 8, 9, 10], "upper": [7, 8, 9, 10], "mean_prob_escape_chart": [7, 8, 9, 10], "05": [7, 8, 9, 10], "125": [7, 8, 9, 10], "relat": [7, 8, 9, 10], "keyword": [7, 8, 9, 10], "argument": [7, 8, 9, 10], "keep": [7, 8, 9, 10], "ad": [7, 8, 9, 10], "until": [7, 8, 9, 10], "reach": [7, 8, 9, 10], "new": [7, 8, 9, 10], "neg": [7, 8, 9, 10], "base": [7, 8, 9, 10], "scheme": [7, 8, 9, 10], "so": [7, 8, 9, 10, 11], "z": [7, 8, 9, 10], "nfit": [7, 8, 9, 10], "data_to_fit": [7, 8, 9, 10], "alphabet": [7, 8, 9, 10], "aas_withstop_withgap": [7, 8, 9, 10], "opt_r": [7, 8, 9, 10], "logfreq": [7, 8, 9, 10], "activity_wt_df": [7, 8, 9, 10], "absolut": [7, 8, 9, 10], "max_escap": [7, 8, 9, 10], "mean_abs_escap": [7, 8, 9, 10], "ab": [7, 8, 9, 10], "stop": [7, 8, 9, 10], "least": [7, 8, 9, 10], "one": [7, 8, 9, 10], "previou": [7, 8, 9, 10], "break": [7, 8, 9, 10], "nthe": [7, 8, 9, 10], "level": [7, 8, 9, 10], "optim": [7, 8, 9, 10], "1178": [7, 8], "tue": [7, 8, 9, 10], "feb": [7, 8, 9, 10], "43": [7, 8, 10], "time_sec": [7, 8, 9, 10], "loss": [7, 8, 9, 10], "fit_loss": [7, 8, 9, 10], "reg_escap": [7, 8, 9, 10], "reg_spread": [7, 8, 9, 10], "reg_spati": [7, 8, 9, 10], "reg_uniqu": [7, 8, 9, 10], "reg_uniqueness2": [7, 8, 9, 10], "reg_act": [7, 8, 9, 10], "051869": 7, "75861": 7, "75860": 7, "68264": [7, 9], "434": 7, "1303": 7, "1256": 7, "41": 7, "8421": 7, "255": 7, "432": 7, "8433": 7, "finish": [7, 8, 9, 10], "32": 7, "7014": [7, 8], "069702": 7, "2376": 7, "2080": 7, "290": 7, "89": 7, "0617e": 7, "30": [7, 8, 9, 10], "885": 7, "1841": 7, "1753": 7, "533": 7, "903": 7, "1452": 7, "209": 7, "534": 7, "505": 7, "916": 7, "1434": 7, "47": 7, "2130_1_prob_escap": [8, 10], "400": [8, 10], "44": [8, 9], "050663": 8, "6164": 8, "6158": 8, "9681": [8, 10], "914": 8, "3597": 8, "3563": 8, "561": 8, "5259": 8, "232": 8, "656": 8, "5254": 8, "068529": 8, "7160": 8, "6988": 8, "168": 8, "55": [8, 10], "2852e": 8, "31": [8, 9, 10], "183": 8, "176": 8, "6553": 8, "6417": 8, "110": 8, "396": 8, "0016": 8, "90551": [9, 10], "1232": [9, 10], "054472": 9, "71752": 9, "71751": 9, "188": [9, 10], "2773": 9, "2734": 9, "34": 9, "939": 9, "0952": 9, "249": 9, "129": 9, "35": 9, "143": 9, "0959": 9, "46": 9, "7706": [9, 10], "068513": 9, "5104": 9, "4875": 9, "225": 9, "1567e": 9, "644": 9, "4483": 9, "4341": 9, "114": 9, "925": 9, "6016": 9, "284": 9, "071": 9, "4481": 9, "4339": 9, "58": 9, "6024": 9, "45": 9, "08": 9, "05364": 10, "7520": 10, "7514": 10, "528": 10, "4769": 10, "4734": 10, "956": 10, "5055": 10, "554": 10, "4768": 10, "061": 10, "5042": 10, "33": 10, "072157": 10, "8608": 10, "8416": 10, "3741e": 10, "934": 10, "8035": 10, "7886": 10, "118": 10, "405": 10, "9675": 10, "269": 10, "541": 10, "8033": 10, "7884": 10, "117": 10, "28": 10, "004": 10, "9651": 10, "page": 11, "document": 11, "For": 11, "actual": 11, "http": 11, "github": 11, "com": 11, "dm": 11, "vep": 11, "studi": 11, "bernadeta": 11, "dadonait": 11, "jess": 11, "bloom": 11, "rulegraph": 11, "filegraph": 11, "neutral": 11, "compar": 11, "parent": 11, "gene": 11, "sequenc": 11, "protein": 11, "sequenti": 11, "process": 11, "experi": 11, "2130_vs_2130": 11, "112_escap": 11}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"probabl": 0, "escap": [0, 2, 3, 4, 11], "neutral": [0, 5], "antibodi": [0, 2, 3, 4, 5, 11], "select": 0, "read": [0, 7, 8, 9, 10], "inform": 0, "fraction": 0, "barcod": [0, 1], "count": [0, 1], "standard": 0, "overal": 0, "number": 0, "mutat": [0, 1, 11], "variant": [0, 1], "suffici": 0, "distribut": 0, "across": [0, 1, 2, 3, 4], "correl": 0, "level": 0, "sequenc": 1, "align": 1, "stat": 1, "uniqu": 1, "other": 1, "estim": 1, "divers": 1, "invalid": 1, "possibl": 1, "librari": 1, "contamin": 1, "get": 1, "codonvariantt": 1, "valid": 1, "averag": [1, 2, 3, 4], "per": 1, "frequenc": 1, "gene": 1, "how": 1, "much": 1, "do": 1, "individu": 1, "domin": 1, "check": 1, "ar": 1, "consist": 1, "file": [1, 11], "replic": 2, "polyclon": [3, 4, 6, 7, 8, 9, 10], "model": [3, 4, 6, 7, 8, 9, 10], "compar": 5, "valu": 5, "fit": [6, 7, 8, 9, 10], "input": [7, 8, 9, 10], "data": [7, 8, 9, 10, 11], "some": [7, 8, 9, 10], "summari": [7, 8, 9, 10], "statist": [7, 8, 9, 10], "deep": 11, "scan": 11, "sar": 11, "cov": 11, "2": 11, "omicron": 11, "ba": 11, "1": 11, "spike": 11, "map": 11, "cov2": 11, "2130": 11, "its": 11, "deriv": 11, "workflow": 11, "analysi": 11, "notebook": 11, "interact": 11, "plot": 11, "addit": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Probabilities of escape and neutralization in antibody selections": [[0, "Probabilities-of-escape-and-neutralization-in-antibody-selections"]], "Read the escape probabilities and neutralization information": [[0, "Read-the-escape-probabilities-and-neutralization-information"]], "Fraction of barcode counts for neutralization standard": [[0, "Fraction-of-barcode-counts-for-neutralization-standard"]], "Overall fraction neutralization by number of mutations": [[0, "Overall-fraction-neutralization-by-number-of-mutations"]], "Variants with sufficient no-antibody counts": [[0, "Variants-with-sufficient-no-antibody-counts"]], "Distribution of probability escape across variants": [[0, "Distribution-of-probability-escape-across-variants"]], "Correlations in variant-level escape probabilities": [[0, "Correlations-in-variant-level-escape-probabilities"]], "Counts of variants": [[1, "Counts-of-variants"]], "Barcode sequencing alignment stats": [[1, "Barcode-sequencing-alignment-stats"]], "Barcode counts": [[1, "Barcode-counts"]], "Unique barcodes and other estimates of diversity": [[1, "Unique-barcodes-and-other-estimates-of-diversity"]], "Invalid barcodes and possible library-to-library contamination": [[1, "Invalid-barcodes-and-possible-library-to-library-contamination"]], "Get CodonVariantTable for valid variant counts": [[1, "Get-CodonVariantTable-for-valid-variant-counts"]], "Average mutations per variant": [[1, "Average-mutations-per-variant"]], "Mutation frequency across the gene": [[1, "Mutation-frequency-across-the-gene"]], "How much do individual variants dominate counts?": [[1, "How-much-do-individual-variants-dominate-counts?"]], "Check counts are consistent with variant count files": [[1, "Check-counts-are-consistent-with-variant-count-files"]], "Antibody-escape averaged across replicates": [[2, "antibody-escape-averaged-across-replicates"]], "Average antibody escape across polyclonal models": [[3, "Average-antibody-escape-across-polyclonal-models"], [4, "Average-antibody-escape-across-polyclonal-models"]], "Compare antibody neutralization values": [[5, "Compare-antibody-neutralization-values"]], "Fit polyclonal models": [[6, "fit-polyclonal-models"]], "Fit polyclonal model": [[7, "Fit-polyclonal-model"], [7, "id1"], [8, "Fit-polyclonal-model"], [8, "id1"], [9, "Fit-polyclonal-model"], [9, "id1"], [10, "Fit-polyclonal-model"], [10, "id1"]], "Read input data": [[7, "Read-input-data"], [8, "Read-input-data"], [9, "Read-input-data"], [10, "Read-input-data"]], "Some summary statistics": [[7, "Some-summary-statistics"], [8, "Some-summary-statistics"], [9, "Some-summary-statistics"], [10, "Some-summary-statistics"]], "Deep mutational scanning of SARS-CoV-2 Omicron BA.1 spike and mapping of escape mutations for COV2-2130 and its derivative antibody": [[11, "deep-mutational-scanning-of-sars-cov-2-omicron-ba-1-spike-and-mapping-of-escape-mutations-for-cov2-2130-and-its-derivative-antibody"]], "Workflow": [[11, "workflow"]], "Analysis notebooks": [[11, "analysis-notebooks"]], "Data files": [[11, "data-files"]], "Interactive plots of mutation antibody escape": [[11, "interactive-plots-of-mutation-antibody-escape"]], "Additional plots": [[11, "additional-plots"]]}, "indexentries": {}})